<script type="text/javascript" src="/assets/view_team_in_grades.js"></script>
<script type="text/javascript">
    github_token = '<%= @token %>';
    $(document).ready(function () {
        $('#tag_prompt_toggler').click(function () {
            if ($('#tag_prompt_toggler').text() == "hide tags")
                $('#tag_prompt_toggler').text("show tags")
            else
                $('#tag_prompt_toggler').text("hide tags")
            $('.tag_prompt_container').toggle();
        });
    });

    function toggleFunction(elementId) {
        var target = document.getElementById(elementId);
        if (target.style.display === 'none') {
            target.style.display = 'block';
        } else {
            target.style.display = 'none';
        }
    }
</script>
<h2>GitHub Metrics for assignment: <%= @assignment.name %></h2>
<h4>Team: <%= @team.name %></h4>

<!--Obtain topic name from assignment helper-->
<% topic_id, topic_name, users_for_curr_team, participants = get_data_for_list_submissions(@team) %>
<% if @assignment.topics? %>
  <h4>Topic: <%= topic_id + '. ' + topic_name %></h4>
<% end %>

<!--Toggle submission-->
<button onclick="toggleFunction('<%= @participant.id.to_s%>')" class="btn btn-default">Show Submission</button>
<div id="<%= @participant.id.to_s %>" style="display:none;">
  <% if @participant.team.hyperlinks.try(:length) %>
    <%= render :partial => 'submitted_content/hyperlink', :locals => {participant: @participant, stage: @stage} %>
  <% else %>
    <b>No Submission</b>
  <% end %>
</div><br><br>


<br>
<div class="chart-container" style="width: 1000px; height:600px;">
  <%= display_github_metrics(@parsed_data, @authors, @dates) %>
</div>
<br>

<br>
<h3 style="font-weight:bold;display:inline-block;">Team Statistics</h3><br/>

Total number of commits:<%= @total_commits %>
<br>
Total number of lines added: <%= @total_additions %>
<br>
Total number of lines removed: <%= @total_deletions %>
<br>
Total number of files changed: <%= @total_files_changed %>
<br>
Merge status:<br>
<% @merge_status.each do |k, v| %>
  Pull Request Number <%= k %> has status: <%= v %> <br>
<% end %>
